<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css"
        integrity="sha384-xOolHFLEh07PJGoPkLv1IbcEPTNtaed2xpHsD9ESMhqIYd0nLMwNLD69Npy4HI+N" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
        integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
        integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js"
        integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+"
        crossorigin="anonymous"></script>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />

    <style>
        body,
        html {
            overflow: hidden;
            background-color: gray;
        }

        body,
        #background {
            margin: 0;
            padding: 0;
        }

        #background {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100vw;
            height: 100vh;
            background-color: lightgray;
            border: 5px solid red;
            /* Add this line */
            box-sizing: border-box;
            /* Add this line to keep the border inside the element */
            perspective: 1000px;
            transition: transform 1s ease-in-out;
            overflow: hidden;
        }

        #character {
            position: absolute;
            width: 40px;
            height: 40px;
            background-color: red;
            z-index: 99;
        }

        #character::after {
            content: "";
            position: absolute;
            top: 50%;
            left: 100%;
            width: 0;
            height: 0;
            border-top: 20px solid transparent;
            border-bottom: 20px solid transparent;
            border-left: 20px solid red;
            transform: translateY(-50%);
        }

        #background-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 10rem;
            color: #c0c0c0;
        }

        .main-container {
            margin-top: 200px;
            position: absolute;
            z-index: 98;
            width: 80%;
            left: 10%;
            right: 10%;
        }
    </style>
</head>

<body>
    <div id="character"></div>
    <div class="container main-container">
        <div class="row page-1">
            <div class="col-md-4 animate__animated animate__fadeInDown">
                <h1 class="">Topic 1</h1>
                <p>Press the right arrow key to move right and rotate the background. Press the left arrow key to move
                    left and rotate the background.</p>
            </div>

            <div class="col-md-4 animate__animated animate__fadeInDown animate__delay-1s">
                <h1 class="">Topic 2</h1>
                <p>Press the right arrow key to move right and rotate the background. Press the left arrow key to move
                    left and rotate the background.</p>
            </div>

            <div class="col-md-4 animate__animated animate__fadeInDown animate__delay-2s">
                <h1 class="">Topic 3</h1>
                <p>Press the right arrow key to move right and rotate the background. Press the left arrow key to move
                    left and rotate the background.</p>
            </div>
        </div>

        <div class="row page-2" style="display: none;">
            <div class="col-md-4 animate__animated animate__fadeInDown">
                <h1 class="">Topic 4</h1>
                <p>Press the right arrow key to move right and rotate the background. Press the left arrow key to move
                    left and rotate the background.</p>
            </div>

            <div class="col-md-4 animate__animated animate__fadeInDown animate__delay-1s">
                <h1 class="">Topic 5</h1>
                <p>Press the right arrow key to move right and rotate the background. Press the left arrow key to move
                    left and rotate the background.</p>
            </div>

            <div class="col-md-4 animate__animated animate__fadeInDown animate__delay-2s">
                <h1 class="">Topic 6</h1>
                <p>Press the right arrow key to move right and rotate the background. Press the left arrow key to move
                    left and rotate the background.</p>
            </div>
        </div>
    </div>
    <div id="background">
        <div id="background-text">Background</div>
    </div>
    <script>
        window.onload = function () {
            var character = document.getElementById('character');
            var background = document.getElementById('background');

            var rotation = 0;

            // function adjustBackground() {
            //     // Set background to fill the window
            //     background.style.width = window.innerWidth + 'px';
            //     background.style.height = window.innerHeight + 'px';
            // }

            // function adjustBackground() {
            //     // Ensuring the background covers the bigger dimension when rotating
            //     var maxDimension = Math.max(window.innerWidth, window.innerHeight);
            //     background.style.width = maxDimension * Math.sqrt(2) + 'px'; // sqrt(2) is approx for diagonal length of square
            //     background.style.height = maxDimension * Math.sqrt(2) + 'px';
            //     background.style.left = (window.innerWidth / 2 - maxDimension * Math.sqrt(2) / 2) + 'px';
            //     background.style.top = (window.innerHeight / 2 - maxDimension * Math.sqrt(2) / 2) + 'px';
            // }

            function adjustBackground() {
                // Calculate the scale factor
                var maxDimension = Math.max(window.innerWidth, window.innerHeight);
                var scaleFactor = maxDimension * Math.sqrt(0.25) / Math.min(window.innerWidth, window.innerHeight);
                // Apply the scale transform
                background.style.transform = 'rotate(' + rotation + 'deg) scale(' + scaleFactor + ')';

                var QWidth = window.innerWidth;
                var QHeight = window.innerHeight;
                console.log("innerWidth" + QWidth, "innerHeight" + QHeight);
            }

            // Call adjustBackground to set initial size
            adjustBackground();

            // Set initial position
            character.style.left = (window.innerWidth / 2) + 'px'; // Set character to the middle
            character.style.bottom = '150px';

            // Set transition property for smooth movement
            character.style.transition = 'left 1s ease-out';

            // Function to handle character movement and background rotation
            function moveCharacter(direction) {
                var left = parseInt(character.style.left.replace('px', ''));
                if (direction === 'right') {
                    character.style.transform = 'scaleX(1)';
                    character.style.left = (left + 100) + 'px';
                    if (left >= (window.innerWidth)) {
                        rotation += 90;
                        background.style.transform = 'rotate(' + rotation + 'deg)';
                        character.style.left = (window.innerWidth / 2) + 'px'; // Move character back to the middle

                        // Delay adjusting the background size
                        setTimeout(adjustBackground, 1000); // Delay by 1 second
                    }

                    // If the background has rotated 90 degrees, show page-2 and hide page-1
                    if (rotation === 90) {
                        $('.page-1').hide();
                        $('.page-2').show();
                    }
                } else if (direction === 'left') {
                    character.style.transform = 'scaleX(-1)';
                    character.style.left = (left - 100) + 'px';
                    if (left <= 0) {
                        rotation -= 90;
                        background.style.transform = 'rotate(' + rotation + 'deg)';
                        character.style.left = (window.innerWidth / 2) + 'px'; // Move character back to the middle

                        // Delay adjusting the background size
                        setTimeout(adjustBackground, 1000); // Delay by 1 second

                        // If the background has rotated back to 0 degrees, show page-1 and hide page-2
                        if (rotation === 0) {
                            $('.page-2').hide();
                            $('.page-1').show();
                        }
                    }
                }
            }

            window.onkeydown = function (event) {
                if (event.key === 'ArrowRight') {
                    moveCharacter('right');
                } else if (event.key === 'ArrowLeft') {
                    moveCharacter('left');
                }
            }

            // Adjust background size on window resize
            window.onresize = adjustBackground;
        }

    </script>
</body>

</html>